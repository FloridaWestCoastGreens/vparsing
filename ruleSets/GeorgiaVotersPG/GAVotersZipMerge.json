{
  "name": "GAVotersZipMerge",
  "rule": "def settings = [\n\timportFolder: '/usr/share/tomcat/Voters/Georgia',\n\timportFolderMac: '/Applications/NetBeans/apache-tomcat-7.0.41/Voters/Georgia'\n]\ndef tempfiles = []\ndef filecount = 0\ndef ln = System.getProperty('line.separator')\nnew File(settings.importFolder).eachDirRecurse() { dir ->\n\tdir.eachFileMatch(~/.*.zip/) { file -> \n\t\tdef zipFile = new java.util.zip.ZipFile(file)\n\t\tdef voterEntry = zipFile.entries().findAll { !it.directory }.max { it.getSize() }\n\t\tdef modificationTime = (new Date(voterEntry.getTime())).format(\"yyyyMMdd\")\n\t\tprintln \"${modificationTime} Mod Time\"\n\t\tprintln \"Entry is ${voterEntry.name}\"\n\t\t\n\t\tdef count = 0\n\t\tdef unparsedTextFile\n\t\tsql.withBatch(20, \"\"\"INSERT INTO \"Georgia\".\"Voters\" (\n\t\t\t\"CountyCode\",\n\t\t\t\"RegistrationNbr\",\n\t\t\t\"VoterStatus\",\n\t\t\t\"VoterLastName\",\n\t\t\t\"VoterFirstName\",\n\t\t\t\"VoterMiddleMaiden\",\n\t\t\t\"VoterNameSuffix\",\n\t\t\t\"VoterNameTitle\",\n\t\t\t\"ResHouseNbr\",\n\t\t\t\"ResStreetName\",\n\t\t\t\"ResStreetSuffix\",\n\t\t\t\"ResAptUnitNbr\",\n\t\t\t\"ResCityName\",\n\t\t\t\"ResZip\",\n\t\t\t\"ResZipPlus4\",\n\t\t\t\"MidrFlag\",\n\t\t\t\"PollWorker\",\n\t\t\t\"TransactionCode\",\n\t\t\t\"TransactionYearMonth\",\n\t\t\t\"Filler1\",\n\t\t\t\"DateOfBirth\",\n\t\t\t\"RegistrationDate\",\n\t\t\t\"Race\",\n\t\t\t\"Gender\",\n\t\t\t\"Absentee\",\n\t\t\t\"LandDistrict\",\n\t\t\t\"LandLot\",\n\t\t\t\"OriginalRegDate\",\n\t\t\t\"StatusReason\",\n\t\t\t\"Filler2\",\n\t\t\t\"CountyPrecinctId\",\n\t\t\t\"CityPrecinctId\",\n\t\t\t\"CongressionalDistrict\",\n\t\t\t\"SenateDistrict\",\n\t\t\t\"HouseDistrict\",\n\t\t\t\"JudicialDistrict\",\n\t\t\t\"CommDistrict\",\n\t\t\t\"SchoolDistrict\",\n\t\t\t\"CountyDistAName\",\n\t\t\t\"CountyDistAValue\",\n\t\t\t\"CountyDistBName\",\n\t\t\t\"CountyDistBValue\",\n\t\t\t\"MunicipalName\",\n\t\t\t\"MunicipalCode\",\n\t\t\t\"WardCityCouncilName\",\n\t\t\t\"WardCityCouncil\",\n\t\t\t\"CitySchoolDistName\",\n\t\t\t\"CitySchoolDist\",\n\t\t\t\"CityDistAName\",\n\t\t\t\"CityDistAValue\",\n\t\t\t\"CityDistBName\",\n\t\t\t\"CityDistBValue\",\n\t\t\t\"CityDistCName\",\n\t\t\t\"CityDistCValue\",\n\t\t\t\"CityDistDName\",\n\t\t\t\"CityDistDValue\",\n\t\t\t\"DateLastVotedDate\",\n\t\t\t\"TypeOfElection\",\n\t\t\t\"PartyLastVoted\",\n\t\t\t\"LastContactDate\",\n\t\t\t\"MailHouseNbr\",\n\t\t\t\"MailStreetName\",\n\t\t\t\"MailStreetSuffix\",\n\t\t\t\"MailAptUnitNbr\",\n\t\t\t\"MailCity\",\n\t\t\t\"MailState\",\n\t\t\t\"MailZip\",\n\t\t\t\"MailZipPlus4\",\n\t\t\t\"Filler3\",\n\t\t\t\"MailAddress2\",\n\t\t\t\"MailAddress3\",\n\t\t\t\"MailCounty\",\n\t\t\t\"DateAdded\",\n\t\t\t\"DateChanged\",\n\t\t\t\"DistrictCombo\",\n\t\t\t\"ResBuilding\",\n\t\t\t\"MailRRPOBox\",\n\t\t\t\"CombinedStreetAddr\",\n\t\t\t\"ExportDate\"\n\t\t) VALUES (\n\t\t\t:CountyCode,\n\t\t\t:RegistrationNbr,\n\t\t\t:VoterStatus,\n\t\t\t:VoterLastName,\n\t\t\t:VoterFirstName,\n\t\t\t:VoterMiddleMaiden,\n\t\t\t:VoterNameSuffix,\n\t\t\t:VoterNameTitle,\n\t\t\t:ResHouseNbr,\n\t\t\t:ResStreetName,\n\t\t\t:ResStreetSuffix,\n\t\t\t:ResAptUnitNbr,\n\t\t\t:ResCityName,\n\t\t\t:ResZip,\n\t\t\t:ResZipPlus4,\n\t\t\t:MidrFlag,\n\t\t\t:PollWorker,\n\t\t\t:TransactionCode,\n\t\t\t:TransactionYearMonth,\n\t\t\t:Filler1,\n\t\t\tto_date(:DateOfBirth, 'YYYYMMDD'),\n\t\t\tto_date(:RegistrationDate, 'YYYYMMDD'),\n\t\t\t:Race,\n\t\t\t:Gender,\n\t\t\t:Absentee,\n\t\t\t:LandDistrict,\n\t\t\t:LandLot,\n\t\t\tto_date(:OriginalRegDate, 'YYYYMMDD'),\n\t\t\t:StatusReason,\n\t\t\t:Filler2,\n\t\t\t:CountyPrecinctId,\n\t\t\t:CityPrecinctId,\n\t\t\t:CongressionalDistrict,\n\t\t\t:SenateDistrict,\n\t\t\t:HouseDistrict,\n\t\t\t:JudicialDistrict,\n\t\t\t:CommDistrict,\n\t\t\t:SchoolDistrict,\n\t\t\t:CountyDistAName,\n\t\t\t:CountyDistAValue,\n\t\t\t:CountyDistBName,\n\t\t\t:CountyDistBValue,\n\t\t\t:MunicipalName,\n\t\t\t:MunicipalCode,\n\t\t\t:WardCityCouncilName,\n\t\t\t:WardCityCouncil,\n\t\t\t:CitySchoolDistName,\n\t\t\t:CitySchoolDist,\n\t\t\t:CityDistAName,\n\t\t\t:CityDistAValue,\n\t\t\t:CityDistBName,\n\t\t\t:CityDistBValue,\n\t\t\t:CityDistCName,\n\t\t\t:CityDistCValue,\n\t\t\t:CityDistDName,\n\t\t\t:CityDistDValue,\n\t\t\tto_date(:DateLastVotedDate, 'YYYYMMDD'),\n\t\t\t:TypeOfElection,\n\t\t\t:PartyLastVoted,\n\t\t\tto_date(:LastContactDate, 'YYYYMMDD'),\n\t\t\t:MailHouseNbr,\n\t\t\t:MailStreetName,\n\t\t\t:MailStreetSuffix,\n\t\t\t:MailAptUnitNbr,\n\t\t\t:MailCity,\n\t\t\t:MailState,\n\t\t\t:MailZip,\n\t\t\t:MailZipPlus4,\n\t\t\t:Filler3,\n\t\t\t:MailAddress2,\n\t\t\t:MailAddress3,\n\t\t\t:MailCounty,\n\t\t\tto_date(:DateAdded, 'YYYYMMDD'),\n\t\t\tto_date(:DateChanged, 'YYYYMMDD'),\n\t\t\t:DistrictCombo,\n\t\t\t:ResBuilding,\n\t\t\t:MailRRPOBox,\n\t\t\t:CombinedStreetAddr,\n\t\t\tto_date(:ExportDate, 'YYYYMMDD')\n\t\t) \"\"\") { ps ->                 \n\t\t\t(new BufferedReader(new InputStreamReader(zipFile.getInputStream(voterEntry), \"UTF-8\"))).eachLine { line ->\n\t\t\t\tdef params = [\n\t\t\t\t\tCountyCode: line[0..2].trim(),\n\t\t\t\t\tRegistrationNbr: line[3..10].trim(),\n\t\t\t\t\tVoterStatus: line[11].trim(),\n\t\t\t\t\tVoterLastName: line[12..31].trim(),\n\t\t\t\t\tVoterFirstName: line[32..51].trim(),\n\t\t\t\t\tVoterMiddleMaiden: line[52..71].trim(),\n\t\t\t\t\tVoterNameSuffix: line[72..74].trim(),\n\t\t\t\t\tVoterNameTitle: line[75..77].trim(),\n\t\t\t\t\tResHouseNbr: line[78..83].trim(),\n\t\t\t\t\tResStreetName: line[84..113].trim(),\n\t\t\t\t\tResStreetSuffix: line[114..115].trim(),\n\t\t\t\t\tResAptUnitNbr: line[116..123].trim(),\n\t\t\t\t\tResCityName: line[124..140].trim(),\n\t\t\t\t\tResZip: line[141..145].trim(),\n\t\t\t\t\tResZipPlus4: line[146..149].trim(),\n\t\t\t\t\tMidrFlag: line[150].trim(),\n\t\t\t\t\tPollWorker: line[151].trim(),\n\t\t\t\t\tTransactionCode: line[152].trim(),\n\t\t\t\t\tTransactionYearMonth: line[153,,158].trim(),\n\t\t\t\t\tFiller1: line[159..160].trim(),\n\t\t\t\t\tDateOfBirth: line[161..168],\n\t\t\t\t\tRegistrationDate: line[169..176],\n\t\t\t\t\tRace: line[177].trim(),\n\t\t\t\t\tGender: line[178].trim(),\n\t\t\t\t\tAbsentee: line[179].trim(),\n\t\t\t\t\tLandDistrict: line[180..182].trim(),\n\t\t\t\t\tLandLot: line[183..186].trim(),\n\t\t\t\t\tOriginalRegDate: line[187..194],\n\t\t\t\t\tStatusReason: line[195..203].trim(),\n\t\t\t\t\tFiller2: line[204..208].trim(),\n\t\t\t\t\tCountyPrecinctId: line[209..213].trim(),\n\t\t\t\t\tCityPrecinctId: line[214..218].trim(),\n\t\t\t\t\tCongressionalDistrict: line[219..221].trim(),\n\t\t\t\t\tSenateDistrict: line[222..224].trim(),\n\t\t\t\t\tHouseDistrict: line[225..227].trim(),\n\t\t\t\t\tJudicialDistrict: line[228..230].trim(),\n\t\t\t\t\tCommDistrict: line[231..233].trim(),\n\t\t\t\t\tSchoolDistrict: line[234..236].trim(),\n\t\t\t\t\tCountyDistAName: line[237..249].trim(),\n\t\t\t\t\tCountyDistAValue: line[250..252].trim(),\n\t\t\t\t\tCountyDistBName: line[253..265].trim(),\n\t\t\t\t\tCountyDistBValue: line[266..268].trim(),\n\t\t\t\t\tMunicipalName: line[269..285].trim(),\n\t\t\t\t\tMunicipalCode: line[286..288].trim(),\n\t\t\t\t\tWardCityCouncilName: line[289..301].trim(),\n\t\t\t\t\tWardCityCouncil: line[302..304].trim(),\n\t\t\t\t\tCitySchoolDistName: line[305..317].trim(),\n\t\t\t\t\tCitySchoolDist: line[318..320].trim(),\n\t\t\t\t\tCityDistAName: line[321..333].trim(),\n\t\t\t\t\tCityDistAValue: line[334..336].trim(),\n\t\t\t\t\tCityDistBName: line[337..349].trim(),\n\t\t\t\t\tCityDistBValue: line[350..352].trim(),\n\t\t\t\t\tCityDistCName: line[353..365].trim(),\n\t\t\t\t\tCityDistCValue: line[366..368].trim(),\n\t\t\t\t\tCityDistDName: line[369..384].trim(),\n\t\t\t\t\tCityDistDValue: line[382..384].trim(),\n\t\t\t\t\tDateLastVotedDate: line[385..392],\n\t\t\t\t\tTypeOfElection: line[393..395].trim(),\n\t\t\t\t\tPartyLastVoted: line[396].trim(),\n\t\t\t\t\tLastContactDate: line[397..404],\n\t\t\t\t\tMailHouseNbr: line[405..410].trim(),\n\t\t\t\t\tMailStreetName: line[411..440].trim(),\n\t\t\t\t\tMailStreetSuffix: line[441..442].trim(),\n\t\t\t\t\tMailAptUnitNbr: line[443..450].trim(),\n\t\t\t\t\tMailCity: line[451..467].trim(),\n\t\t\t\t\tMailState: line[468..469].trim(),\n\t\t\t\t\tMailZip: line[470..474].trim(),\n\t\t\t\t\tMailZipPlus4: line[475..478].trim(),\n\t\t\t\t\tFiller3: line[479..480].trim(),\n\t\t\t\t\tMailAddress2: line[481..510].trim(),\n\t\t\t\t\tMailAddress3: line[511..540].trim(),\n\t\t\t\t\tMailCounty: line[541..560].trim(),\n\t\t\t\t\tDateAdded: line[561..568],\n\t\t\t\t\tDateChanged: line[569..576],\n\t\t\t\t\tDistrictCombo: line[577..579].trim(),\n\t\t\t\t\tResBuilding: line[580..582].trim(),\n\t\t\t\t\tMailRRPOBox: line[583..590].trim(),\n\t\t\t\t\tCombinedStreetAddr: line[591..<651].trim(),\n\t\t\t\t\tExportDate: modificationTime,\n\t\t\t\t]\n\t\t\t\tps.addBatch(params)\n\t\t\t}\n\t\t\t\n\t\t}\t\t\n\t\t\n\t\t\n\t\t\t\t\t\n\t}\n}\t\n\n",
  "class": "edu.usf.RuleChains.Groovy"
}